# Название задачи: SURF

### Выполнено командой: *Борисов Сергей, Авакян Гор*

### Постановка задачи: 
Протестировать метод  SURF  (реализованный в OpenCV) на различных видах изображений. Подобрать наборы с положительными и отрицательными примерами 

### План работы:
1. С помощью детектора локальных особенностей SURF находим особые точки на образце и изображении.
2. Для найденных точек рассчитываем в их окрестностях значения дескрипторов. Дескриптор — это многомерный вектор, характеризующий точку. Чем больше похожи два дескриптора(чем меньше расстояние между ними), тем более вероятно, что речь идет об одной и той же точке на образце и текущем изображении.
3. Каждой особой точке на одном изображении сопоставляем точку с другого по минимальному расстоянию между дескрипторами(количество найденных точек на изображениях скорее всего будет разным, но одна и та же точка образца может быть наилучшим кандидатом для нескольких точек с изображения). Такое сопоставление будет скорее всего в большинстве своем неверно, поэтому нужно отфильтровать ложные соответствия.
4. Ложные соответствия хорошо фильтруются алгоритмом RANSAC. Алгоритм пытается по вышенайденным точкам найти преобразование, которое позволило бы наилучшим образом сопоставить два изображения. Если такое преобразование находится и достаточно большое количество точек подтверждает эту модель(такие точки называют инлайнами), то скорее всего объект на изображении присутствует.

### Используемые методы:
1. SurfFeatureDetector (hessianThreshold от 400 до 1000, зависит от контраста изображения)
2. FREAK extractor / BriefDescriptorExtractor / SurfDescriptorExtractor
3. BruteForceMatcher<Hamming> / FlannBasedMatcher
4. findHomography(obj, scene, CV_RANSAC)

### Результаты работы алгоритма:

1. Хорошо выделяет искомые объекты на изображении, если объект не подвергнут повороту в трёхмерной плоскости.
2. Отмасштабированный объект на изображении не влияет на его нахождение алгоритмом, находит также хорошо.
3. Если объект на изображении повёрнут в двухмерной плоскости, то оно также будет распознано.
4. С большой вероятностью находит частично скрытые объекты на изображении.

### Недостатки:

1. Плохо работает с рисованными картинками, было проверенно множество картинок из мультфильмов, часто не распознает. 
2. Сжатие изображения очень влияет на работу алгоритма. Один и тот же объект, но в разных форматах (png и jpg например) будет распознан по разному на изображении.
3. Искажения объекта на изображении также не подвергаются распознаванию. Например, надписи на различных изображениях не всегда находятся.
4. Алгоритм не является распознавателем образов. То что понятно человеку, не всегда понятно SURF'у. Например, один вид знаков ограничения скорости он может распознать, а если немножко изменить его (странно что у нас вообще существуют разные знаки) то уже этот знак ограничения скорости не будет найден на изображении.

### Примеры работы:

![](img/Example1.PNG?raw=true)

![](img/Example2.PNG?raw=true)

![](img/Example3.PNG?raw=true)

### Особенности:

Программа на C++ запускается из командной строки так:
> .\ConsoleApplication1 <Имя объекта> <Имя сцены>
Важно указывать расширение картинки.

В коде можно "играться" следующими строчками:

> // FREAK extractor; // 
>	// BriefDescriptorExtractor extractor; // 

Раскомментировав одну из них, мы выберем один из дескрипторов. На некоторых примерах один работает лучше другого.

Внимание! Для работы программы на C++ необходимо указать пути к библиотеке opencv, установленной на вашем компьютере.
Для работы программы на C# требуется установить через NuGet последнюю версию библиотеки OpenCvSharp третьей версии.

